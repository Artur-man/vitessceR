---
title: "Usage with SeuratData"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Usage with SeuratData}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

The following is an example of usage of the widget with a [Seurat](https://satijalab.org/seurat/) object loaded from the [SeuratData](https://github.com/satijalab/seurat-data) package.

First, set up the [Python environment](./local_data_overview.html):

```r
library(reticulate)
use_condaenv("vitessce-r-env", required = TRUE)
```

Next, install the R dependencies:

```r
install.packages("seurat")
install.packages("devtools")
devtools::install_github("satijalab/seurat-data")
devtools::install_github("mojaveazure/seurat-disk")
devtools::install_github("vitessce/vitessce-r")
```

Next, download the dataset, load and preprocess the Seurat object, and configure the Vitessce widget:

```r
library(vitessce)
library(SeuratData)

SeuratData::InstallData("pbmc3k")
data("pbmc3k.final")
force(pbmc3k.final)

vc <- VitessceConfig$new("My config")
dataset <- vc$add_dataset("My dataset")
dataset <- dataset$add_object(SeuratWrapper$new(
  pbmc3k.final,
  cell_embeddings = c("pca", "umap"),
  cell_embedding_names = c("PCA", "UMAP"),
  cell_set_meta_names = c("seurat_annotations", "seurat_clusters"),
  out_dir = "seurat"
))
scatterplot_pca <- vc$add_view(dataset, Component$SCATTERPLOT, mapping = "PCA")
scatterplot_umap <- vc$add_view(dataset, Component$SCATTERPLOT, mapping = "UMAP")
cell_sets <- vc$add_view(dataset, Component$CELL_SETS)
genes <- vc$add_view(dataset, Component$GENES)
vc$layout(vconcat(
  hconcat(scatterplot_pca, scatterplot_umap),
  hconcat(cell_sets, genes)
))
vc$widget(theme = "light")
```



